(self.webpackChunkwemogy=self.webpackChunkwemogy||[]).push([[516],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return u},kt:function(){return d}});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var c=r.createContext({}),l=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=l(e.components);return r.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,c=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),m=l(n),d=o,f=m["".concat(c,".").concat(d)]||m[d]||p[d]||a;return n?r.createElement(f,i(i({ref:t},u),{},{components:n})):r.createElement(f,i({ref:t},u))}));function d(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=m;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:o,i[1]=s;for(var l=2;l<a;l++)i[l]=n[l];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},6293:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return l},metadata:function(){return u},toc:function(){return p},default:function(){return d}});var r=n(2122),o=n(9756),a=(n(7294),n(3905)),i=n(1395),s=n(8215),c=["components"],l={sidebar_position:1},u={unversionedId:"identity/scenarios/frontend",id:"identity/scenarios/frontend",isDocsHomePage:!1,title:"Frontend App",description:"When interacting with users, that use an application on their devices, we often need some sorts of frontend applications. In wemogy Identity, we differentiate between two types of frontend apps.",source:"@site/docs-modules/identity/scenarios/frontend.mdx",sourceDirName:"identity/scenarios",slug:"/identity/scenarios/frontend",permalink:"/modules/identity/scenarios/frontend",editUrl:"https://github.com/wemogy/documentation/edit/main/docs-modules/identity/scenarios/frontend.mdx",version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Introduction",permalink:"/modules/identity/intro"},next:{title:"Machine to Machine",permalink:"/modules/identity/scenarios/machine-to-machine"}},p=[{value:"First Party App",id:"first-party-app",children:[{value:"Create a client",id:"create-a-client",children:[]},{value:"Create the UI",id:"create-the-ui",children:[]}]},{value:"Third Party App",id:"third-party-app",children:[{value:"Create a client",id:"create-a-client-1",children:[]}]}],m={toc:p};function d(e){var t=e.components,n=(0,o.Z)(e,c);return(0,a.kt)("wrapper",(0,r.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"When interacting with users, that use an application on their devices, we often need some sorts of frontend applications. In wemogy Identity, we differentiate between two types of frontend apps."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"A ",(0,a.kt)("strong",{parentName:"li"},"First Party App")," is authored by the owner of the Identity service and hosts the screens for login, registration, user consent and more."),(0,a.kt)("li",{parentName:"ul"},"A ",(0,a.kt)("strong",{parentName:"li"},"Third Party App")," interacts with the Identity Service only as a Login Provider via OAuth2 or Open ID Connect but does not implement any first-part flows.")),(0,a.kt)("p",null,"Usually, an application has one First Party App and can have no to multiple Third Party Apps."),(0,a.kt)("h2",{id:"first-party-app"},"First Party App"),(0,a.kt)("h3",{id:"create-a-client"},"Create a client"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'curl --request POST \'http://<ADMIN_ENDPOINT>/client\' \\\n--header \'Content-Type: application/json\' \\\n--data-raw \'{\n  "client_id": "<YOUR_CLIENT_ID>",\n  "audience": [ "https://localhost:5001/" ],\n  "grant_types": [ "authorization_code", "refresh_token" ],\n  "response_types": [ "code" ],\n  "scope": "offline_access",\n  "redirect_uris": [ "<YOUR_DOMAIN>/callback" ],\n  "client_type": "frontend"\n}\'\n')),(0,a.kt)("h3",{id:"create-the-ui"},"Create the UI"),(0,a.kt)("p",null,"As a First Part App, you need to implement the following screens, which need to render a form and communicate with the identity service:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Login"),(0,a.kt)("li",{parentName:"ul"},"Registration"),(0,a.kt)("li",{parentName:"ul"},"Consent"),(0,a.kt)("li",{parentName:"ul"},"Account Verification"),(0,a.kt)("li",{parentName:"ul"},"Account Recovery"),(0,a.kt)("li",{parentName:"ul"},"Account Settings"),(0,a.kt)("li",{parentName:"ul"},"Callback")),(0,a.kt)("p",null,"The form is required to collect information, that the identity service needs for the according flows. Each flow that is coming from the API contains all information about the form to render. It is recommended to use the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/wemogy/form-generator"},"wemogy Form Generator")," to render the forms."),(0,a.kt)("p",null,"Communication with the identity service itself should be done by using the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/wemogy/identity/tree/main/libs"},"wemogy Identity SDKs"),"."),(0,a.kt)(i.Z,{groupId:"framework",defaultValue:"react",values:[{label:"React",value:"react"}],mdxType:"Tabs"},(0,a.kt)(s.Z,{value:"react",mdxType:"TabItem"},(0,a.kt)("p",null,"Add the wemogy Identity and Form Generator packages."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"yarn add @wemogy/identity @wemogy/form-generator-react\n")),(0,a.kt)("p",null,"In your App Component, create a new instance of ",(0,a.kt)("inlineCode",{parentName:"p"},"AuthService"),". We are using ",(0,a.kt)("a",{parentName:"p",href:"https://reactrouter.com/"},"React Router")," in this sample, but it can be done with any other routing solution as well."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'title="App.tsx"',title:'"App.tsx"'},"import './App.css';\nimport { Route, BrowserRouter as Router, Switch, Link } from 'react-router-dom';\nimport Login from './components/login/Login';\nimport { AuthConfiguration, AuthService, IAuthService } from '@wemogy/identity';\n\n// Create one global AuthService instance\nconst authService: IAuthService = new AuthService(\n  new AuthConfiguration(\n    'browser',\n    '<YOUR_WEMOGY_IDENTITY_URL>',\n    '<CLIENT_ID>',\n    'http://localhost:3000/callback',\n    '<YOUR_SCOPE>',\n    '<YOUR_AUDIENCE>'\n  )\n);\n\nfunction App() {\n  return (\n    <Router>\n      <Switch>\n        <Route path=\"/login\">\n          <Login authService={authService} />\n        </Route>\n\n        {/* ... */}\n      </Switch>\n    </Router>\n  );\n}\n\nexport default App;\n")),(0,a.kt)("p",null,"Create a component for each screen. Below you can find an example for the Login screen."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-tsx",metastring:'title="Login.tsx"',title:'"Login.tsx"'},"import * as React from 'react';\nimport { useEffect, useState } from 'react';\nimport { IAuthService } from '@wemogy/identity';\nimport { GeneratedForm } from '@wemogy/form-generator-react';\nimport { IForm, IMessage } from '@wemogy/form-generator';\nimport { Link } from 'react-router-dom';\n\ntype LoginProps = {\n  authService: IAuthService;\n};\n\ntype LoginState = {\n  messages: IMessage[];\n  form: IForm | undefined;\n};\n\nconst Login: React.FC<LoginProps> = props => {\n  const [state, setState] = useState<LoginState>({ messages: [], form: undefined });\n\n  useEffect(() => {\n    const func = async () => {\n      const flow = await props.authService.initLoginFlowAsync();\n      if (flow) {\n        setState({ messages: flow.messages, form: flow.form });\n      }\n    };\n    func();\n  }, [props.authService]);\n\n  if (!state.form) {\n    return null;\n  }\n\n  return (\n    <div>\n      <h2>Login</h2>\n\n      {/* Messages */}\n      {state.messages.map(message => (\n        <span key={message.content}>\n          <b>{message.content}</b>\n        </span>\n      ))}\n\n      {/* Login Form */}\n      <GeneratedForm form={state.form} />\n      <Link to=\"/recovery\">Forgot password</Link>\n    </div>\n  );\n};\n\nexport default Login;\n")))),(0,a.kt)("h2",{id:"third-party-app"},"Third Party App"),(0,a.kt)("p",null,"TBD..."),(0,a.kt)("h3",{id:"create-a-client-1"},"Create a client"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'curl --request POST \'http://<ADMIN_ENDPOINT>/client\' \\\n--header \'Content-Type: application/json\' \\\n--data-raw \'{\n  "client_id": "<YOUR_CLIENT_ID>",\n  "audience": [ "https://localhost:5001/" ],\n  "grant_types": [ "authorization_code", "refresh_token" ],\n  "response_types": [ "code" ],\n  "scope": "openid offline_access",\n  "redirect_uris": [ "<YOUR_DOMAIN>/callback" ],\n  "client_type": "frontend"\n}\'\n')))}d.isMDXComponent=!0},8215:function(e,t,n){"use strict";var r=n(7294);t.Z=function(e){var t=e.children,n=e.hidden,o=e.className;return r.createElement("div",{role:"tabpanel",hidden:n,className:o},t)}},1395:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(7294),o=n(944),a=n(6010),i="tabItem_1uMI",s="tabItemActive_2DSg";var c=37,l=39;var u=function(e){var t=e.lazy,n=e.block,u=e.defaultValue,p=e.values,m=e.groupId,d=e.className,f=(0,o.Z)(),h=f.tabGroupChoices,y=f.setTabGroupChoices,g=(0,r.useState)(u),v=g[0],b=g[1],w=r.Children.toArray(e.children),k=[];if(null!=m){var N=h[m];null!=N&&N!==v&&p.some((function(e){return e.value===N}))&&b(N)}var I=function(e){var t=e.currentTarget,n=k.indexOf(t),r=p[n].value;b(r),null!=m&&(y(m,r),setTimeout((function(){var e,n,r,o,a,i,c,l;(e=t.getBoundingClientRect(),n=e.top,r=e.left,o=e.bottom,a=e.right,i=window,c=i.innerHeight,l=i.innerWidth,n>=0&&a<=l&&o<=c&&r>=0)||(t.scrollIntoView({block:"center",behavior:"smooth"}),t.classList.add(s),setTimeout((function(){return t.classList.remove(s)}),2e3))}),150))},O=function(e){var t,n;switch(e.keyCode){case l:var r=k.indexOf(e.target)+1;n=k[r]||k[0];break;case c:var o=k.indexOf(e.target)-1;n=k[o]||k[k.length-1]}null==(t=n)||t.focus()};return r.createElement("div",{className:"tabs-container"},r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.Z)("tabs",{"tabs--block":n},d)},p.map((function(e){var t=e.value,n=e.label;return r.createElement("li",{role:"tab",tabIndex:v===t?0:-1,"aria-selected":v===t,className:(0,a.Z)("tabs__item",i,{"tabs__item--active":v===t}),key:t,ref:function(e){return k.push(e)},onKeyDown:O,onFocus:I,onClick:I},n)}))),t?(0,r.cloneElement)(w.filter((function(e){return e.props.value===v}))[0],{className:"margin-vert--md"}):r.createElement("div",{className:"margin-vert--md"},w.map((function(e,t){return(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==v})}))))}},9443:function(e,t,n){"use strict";var r=(0,n(7294).createContext)(void 0);t.Z=r},944:function(e,t,n){"use strict";var r=n(7294),o=n(9443);t.Z=function(){var e=(0,r.useContext)(o.Z);if(null==e)throw new Error("`useUserPreferencesContext` is used outside of `Layout` Component.");return e}},6010:function(e,t,n){"use strict";function r(e){var t,n,o="";if("string"==typeof e||"number"==typeof e)o+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=r(e[t]))&&(o&&(o+=" "),o+=n);else for(t in e)e[t]&&(o&&(o+=" "),o+=t);return o}function o(){for(var e,t,n=0,o="";n<arguments.length;)(e=arguments[n++])&&(t=r(e))&&(o&&(o+=" "),o+=t);return o}n.d(t,{Z:function(){return o}})}}]);